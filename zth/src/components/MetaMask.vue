<script setup lang="ts">
import axios from 'axios';
import { onMounted, ref, nextTick } from 'vue';

const isLoggedIn = ref(false);
const dialog2 = ref(null);
const address = ref('');
const isMetamaskSupported = ref(false);

onMounted(() => {
  isMetamaskSupported.value = typeof (window as any).ethereum !== 'undefined';
});
async function connectWallet() {
  const accounts = await (window as any).ethereum.request({
    method: 'eth_requestAccounts',
  });
  address.value = accounts[0];
  axios
      .post('http://localhost:3030/balance', { name: address.value })
    .then((res) => {
      console.log(res.data);
    })
    .catch((err) => {
      console.log(err);
    });
}
function dialog() {
  // dialog2.value.showModal()
}
</script>

<template>
  <div class="meta__mask">
    <div v-if="!isLoggedIn">
      <button @click="connectWallet()" class="meta__mask-login">
        Metamask Login
      </button>
      <dialog ref="dialog2"></dialog>
    </div>
  </div>
</template>

<style scoped lang="scss">
.meta__mask {
  &-login {
    color: white;
    width: 10rem;
    height: 10rem;
    margin-right: 2rem;
  }
}
</style>
